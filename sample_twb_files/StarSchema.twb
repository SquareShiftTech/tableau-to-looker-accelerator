<?xml version='1.0' encoding='utf-8' ?>
<workbook original-version='18.1' source-build='2025.2.0' source-platform='win' version='18.1'>
  <datasources>
    <datasource caption='Star Schema Sales' inline='true' name='star_schema_sales' version='18.1'>
      <connection class='federated'>
        <named-connections>
          <named-connection caption='BigQuery' name='bigquery.star_schema'>
            <connection CATALOG='sales-analytics-project' EXECCATALOG='sales-dwh' authentication='oauth' class='bigquery' connection-dialect='google-sql' project='sales-analytics' schema='warehouse' server-oauth='' username='analytics@company.com' />
          </named-connection>
        </named-connections>
        <relation type='collection'>
          <relation connection='bigquery.star_schema' name='sales_fact' table='[sales-analytics-project.warehouse].[sales_fact]' type='table' />
          <relation connection='bigquery.star_schema' name='customer_dim' table='[sales-analytics-project.warehouse].[customer_dim]' type='table' />
          <relation connection='bigquery.star_schema' name='product_dim' table='[sales-analytics-project.warehouse].[product_dim]' type='table' />
          <relation connection='bigquery.star_schema' name='time_dim' table='[sales-analytics-project.warehouse].[time_dim]' type='table' />
          <relation connection='bigquery.star_schema' name='region_dim' table='[sales-analytics-project.warehouse].[region_dim]' type='table' />
        </relation>
        <cols>
          <!-- Sales Fact Columns -->
          <map key='[sales_id]' value='[sales_fact].[sales_id]' />
          <map key='[customer_key]' value='[sales_fact].[customer_key]' />
          <map key='[product_key]' value='[sales_fact].[product_key]' />
          <map key='[time_key]' value='[sales_fact].[time_key]' />
          <map key='[region_key]' value='[sales_fact].[region_key]' />
          <map key='[quantity]' value='[sales_fact].[quantity]' />
          <map key='[revenue]' value='[sales_fact].[revenue]' />
          <map key='[profit]' value='[sales_fact].[profit]' />

          <!-- Customer Dimension -->
          <map key='[customer_id (customer_dim)]' value='[customer_dim].[customer_id]' />
          <map key='[customer_name]' value='[customer_dim].[customer_name]' />
          <map key='[customer_segment]' value='[customer_dim].[customer_segment]' />
          <map key='[customer_country]' value='[customer_dim].[customer_country]' />

          <!-- Product Dimension -->
          <map key='[product_id (product_dim)]' value='[product_dim].[product_id]' />
          <map key='[product_name]' value='[product_dim].[product_name]' />
          <map key='[product_category]' value='[product_dim].[product_category]' />
          <map key='[product_subcategory]' value='[product_dim].[product_subcategory]' />
          <map key='[unit_price]' value='[product_dim].[unit_price]' />

          <!-- Time Dimension -->
          <map key='[time_id (time_dim)]' value='[time_dim].[time_id]' />
          <map key='[date_full]' value='[time_dim].[date_full]' />
          <map key='[year]' value='[time_dim].[year]' />
          <map key='[quarter]' value='[time_dim].[quarter]' />
          <map key='[month]' value='[time_dim].[month]' />

          <!-- Region Dimension -->
          <map key='[region_id (region_dim)]' value='[region_dim].[region_id]' />
          <map key='[region_name]' value='[region_dim].[region_name]' />
          <map key='[country]' value='[region_dim].[country]' />
          <map key='[continent]' value='[region_dim].[continent]' />
        </cols>
        <metadata-records>
          <!-- Sales Fact metadata -->
          <metadata-record class='column'>
            <remote-name>sales_id</remote-name>
            <remote-type>20</remote-type>
            <local-name>[sales_id]</local-name>
            <parent-name>[sales_fact]</parent-name>
            <remote-alias>sales_id</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
            <object-id>[sales_fact_001]</object-id>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>customer_key</remote-name>
            <remote-type>20</remote-type>
            <local-name>[customer_key]</local-name>
            <parent-name>[sales_fact]</parent-name>
            <remote-alias>customer_key</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>product_key</remote-name>
            <remote-type>20</remote-type>
            <local-name>[product_key]</local-name>
            <parent-name>[sales_fact]</parent-name>
            <remote-alias>product_key</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>revenue</remote-name>
            <remote-type>5</remote-type>
            <local-name>[revenue]</local-name>
            <parent-name>[sales_fact]</parent-name>
            <remote-alias>revenue</remote-alias>
            <local-type>real</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>

          <!-- Customer Dimension metadata -->
          <metadata-record class='column'>
            <remote-name>customer_id</remote-name>
            <remote-type>20</remote-type>
            <local-name>[customer_id (customer_dim)]</local-name>
            <parent-name>[customer_dim]</parent-name>
            <remote-alias>customer_id</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>customer_name</remote-name>
            <remote-type>130</remote-type>
            <local-name>[customer_name]</local-name>
            <parent-name>[customer_dim]</parent-name>
            <remote-alias>customer_name</remote-alias>
            <local-type>string</local-type>
            <aggregation>Count</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>customer_segment</remote-name>
            <remote-type>130</remote-type>
            <local-name>[customer_segment]</local-name>
            <parent-name>[customer_dim]</parent-name>
            <remote-alias>customer_segment</remote-alias>
            <local-type>string</local-type>
            <aggregation>Count</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>

          <!-- Product Dimension metadata -->
          <metadata-record class='column'>
            <remote-name>product_id</remote-name>
            <remote-type>20</remote-type>
            <local-name>[product_id (product_dim)]</local-name>
            <parent-name>[product_dim]</parent-name>
            <remote-alias>product_id</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
          <metadata-record class='column'>
            <remote-name>product_name</remote-name>
            <remote-type>130</remote-type>
            <local-name>[product_name]</local-name>
            <parent-name>[product_dim]</parent-name>
            <remote-alias>product_name</remote-alias>
            <local-type>string</local-type>
            <aggregation>Count</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>

          <!-- Time Dimension metadata -->
          <metadata-record class='column'>
            <remote-name>time_id</remote-name>
            <remote-type>20</remote-type>
            <local-name>[time_id (time_dim)]</local-name>
            <parent-name>[time_dim]</parent-name>
            <remote-alias>time_id</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>

          <!-- Region Dimension metadata -->
          <metadata-record class='column'>
            <remote-name>region_id</remote-name>
            <remote-type>20</remote-type>
            <local-name>[region_id (region_dim)]</local-name>
            <parent-name>[region_dim]</parent-name>
            <remote-alias>region_id</remote-alias>
            <local-type>integer</local-type>
            <aggregation>Sum</aggregation>
            <contains-null>true</contains-null>
          </metadata-record>
        </metadata-records>
      </connection>
      <object-graph>
        <objects>
          <object caption='sales_fact' id='sales_fact_001'>
            <properties context=''>
              <relation connection='bigquery.star_schema' name='sales_fact' table='[sales-analytics-project.warehouse].[sales_fact]' type='table' />
            </properties>
          </object>
          <object caption='customer_dim' id='customer_dim_001'>
            <properties context=''>
              <relation connection='bigquery.star_schema' name='customer_dim' table='[sales-analytics-project.warehouse].[customer_dim]' type='table' />
            </properties>
          </object>
          <object caption='product_dim' id='product_dim_001'>
            <properties context=''>
              <relation connection='bigquery.star_schema' name='product_dim' table='[sales-analytics-project.warehouse].[product_dim]' type='table' />
            </properties>
          </object>
          <object caption='time_dim' id='time_dim_001'>
            <properties context=''>
              <relation connection='bigquery.star_schema' name='time_dim' table='[sales-analytics-project.warehouse].[time_dim]' type='table' />
            </properties>
          </object>
          <object caption='region_dim' id='region_dim_001'>
            <properties context=''>
              <relation connection='bigquery.star_schema' name='region_dim' table='[sales-analytics-project.warehouse].[region_dim]' type='table' />
            </properties>
          </object>
        </objects>
        <relationships>
          <!-- Sales Fact to Customer Dimension -->
          <relationship>
            <expression op='='>
              <expression op='[customer_key]' />
              <expression op='[customer_id (customer_dim)]' />
            </expression>
            <first-end-point object-id='sales_fact_001' />
            <second-end-point object-id='customer_dim_001' />
          </relationship>

          <!-- Sales Fact to Product Dimension -->
          <relationship>
            <expression op='='>
              <expression op='[product_key]' />
              <expression op='[product_id (product_dim)]' />
            </expression>
            <first-end-point object-id='sales_fact_001' />
            <second-end-point object-id='product_dim_001' />
          </relationship>

          <!-- Sales Fact to Time Dimension -->
          <relationship>
            <expression op='='>
              <expression op='[time_key]' />
              <expression op='[time_id (time_dim)]' />
            </expression>
            <first-end-point object-id='sales_fact_001' />
            <second-end-point object-id='time_dim_001' />
          </relationship>

          <!-- Sales Fact to Region Dimension -->
          <relationship>
            <expression op='='>
              <expression op='[region_key]' />
              <expression op='[region_id (region_dim)]' />
            </expression>
            <first-end-point object-id='sales_fact_001' />
            <second-end-point object-id='region_dim_001' />
          </relationship>
        </relationships>
      </object-graph>
    </datasource>
  </datasources>
  <worksheets>
    <worksheet name='Sales Dashboard'>
    </worksheet>
  </worksheets>
</workbook>
